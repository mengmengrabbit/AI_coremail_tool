# 邮件智能管理系统

## 项目简介

邮件智能管理系统是一个基于Python和Flask的Web应用，用于智能化管理和分类本地邮件文件夹中的邮件。系统能够自动识别特定类型的邮件，并按照不同的业务类别进行分类展示，提高邮件处理效率。

## 项目结构

```
├── docs/               # 文档目录
├── src/                # 源代码目录
│   ├── core/           # 核心功能模块
│   ├── utils/          # 工具类和配置
│   ├── web/            # Web应用相关代码
│   ├── requirements.txt # 依赖包列表
│   └── start.py        # 应用启动脚本
├── static/             # 静态资源文件
│   ├── css/            # CSS样式文件
│   └── js/             # JavaScript文件
├── templates/          # HTML模板文件
├── tests/              # 测试代码
└── main.py             # 应用入口文件
```

## 功能特点

- **专利审查临期提醒**：自动识别专利审查通知邮件，提取答复期限，并按照期限由近及远排序展示
- **专利授权证书汇总**：汇总展示专利授权证书相关邮件（待开发）
- **专利费用发票汇总**：汇总展示专利费用发票相关邮件（待开发）
- **软件行业协会通知汇总**：汇总展示软件行业协会通知相关邮件（待开发）
- **紧急程度可视化**：根据答复期限自动计算紧急程度，并通过颜色进行直观展示
- **统计数据展示**：展示各类邮件的数量统计信息

## 环境安装与配置

### 系统要求

- Python 3.6+
- 依赖包：Flask, chardet, requests, python-dateutil, pathlib2

### 安装步骤

1. 克隆或下载本项目到本地

2. 安装依赖包：

   ```bash
   # 使用项目根目录下的依赖文件安装
   pip install -r src/requirements.txt
   ```

3. 配置邮件文件夹路径

   默认情况下，系统会尝试读取以下路径的邮件：

   ```
   D:\学习\2025\app\邮件导出\收件箱
   ```

   如需修改邮件文件夹路径，请编辑`src/core/email_manager.py`文件中的`base_path`参数。

4. 配置邮箱服务器设置（可选）

   系统配置文件位于`src/utils/settings.py`，可以根据需要修改邮箱账户、服务器设置等配置项。

## 启动与使用

### 启动应用

运行以下命令启动应用：

```bash
# 在项目根目录下执行
python main.py
```

系统会自动执行以下操作：
1. 检查依赖是否已安装，如未安装则自动安装
2. 启动Flask Web服务器
3. 自动在浏览器中打开管理界面（http://localhost:5000）

### 使用测试数据

如果无法访问真实的邮件文件夹，系统会自动切换到测试数据模式，使用`tests/test_emails.py`中的模拟数据进行展示。测试模式下，系统会显示3条模拟的专利审查临期提醒邮件，分别具有不同的紧急程度。

### 停止应用

在命令行窗口中按下`Ctrl+C`组合键可以停止应用。

## 开发计划

- [x] 专利审查临期提醒功能
- [ ] 专利授权证书汇总功能
- [ ] 专利费用发票汇总功能
- [ ] 软件行业协会通知汇总功能
- [ ] 邮件内容全文搜索功能
- [ ] 导出报表功能

## 注意事项

- 系统目前仅支持本地邮件文件夹的处理，不支持直接连接邮箱服务器
- 支持的邮件格式包括.eml、.msg和.mbox
- 首次运行时可能需要一些时间来扫描和解析邮件文件
- 如遇到Python环境问题，请确保使用的是Python 3.6+版本，并且正确安装了所有依赖包